<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 ICARUS COMPLETE - Advanced Crafting Calculator</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.4/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 30%, #16213e 100%);
            color: #ffffff;
            line-height: 1.6;
            min-height: 100vh;
        }

        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .app-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .app-title {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(135deg, #00d4ff 0%, #ff6b6b 50%, #4ecdc4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .app-subtitle {
            font-size: 1.2rem;
            color: #b0b3b8;
            font-weight: 500;
        }

        .stats-header {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .loading-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 50vh;
            gap: 20px;
        }

        .loading-spinner {
            border: 4px solid rgba(255,255,255,0.1);
            border-left: 4px solid #00d4ff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: #00d4ff;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .loading-details {
            color: #b0b3b8;
            font-size: 0.9rem;
        }

        .error-screen {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            color: #ff6b6b;
        }

        .error-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .error-message {
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .retry-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .retry-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            align-items: start;
        }

        .content-panel {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
            min-height: 600px;
        }

        .tab-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            background: rgba(0,0,0,0.3);
            padding: 5px;
            border-radius: 15px;
        }

        .tab-button {
            flex: 1;
            padding: 12px 20px;
            background: transparent;
            border: none;
            color: #b0b3b8;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.3);
        }

        .tab-button:hover:not(.active) {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .search-controls {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .search-input, .filter-select {
            padding: 12px 16px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .search-input::placeholder {
            color: #b0b3b8;
        }

        .filter-select option {
            background: #1a1a2e;
            color: white;
        }

        .map-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .map-label {
            color: #b0b3b8;
            font-weight: 600;
            margin-right: 10px;
        }

        .map-btn {
            padding: 10px 16px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 600;
        }

        .map-btn.active {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            border-color: #ff6b6b;
            transform: translateY(-1px);
        }

        .map-btn:hover:not(.active) {
            background: rgba(255,255,255,0.2);
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
            max-height: 500px;
            overflow-y: auto;
            padding: 10px;
            padding-right: 15px;
        }

        .items-grid::-webkit-scrollbar {
            width: 8px;
        }

        .items-grid::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        .items-grid::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
        }

        .item-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.04) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .item-card:hover {
            background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.08) 100%);
            border-color: rgba(0, 212, 255, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.15);
        }

        .item-card.selected {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.3) 0%, rgba(0, 212, 255, 0.15) 100%);
            border-color: #00d4ff;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.4);
        }

        .item-card.unavailable {
            opacity: 0.6;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2) 0%, rgba(255, 107, 107, 0.1) 100%);
            border-color: rgba(255, 107, 107, 0.4);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .item-name {
            font-weight: 700;
            font-size: 13px;
            color: #ffffff;
            flex: 1;
            line-height: 1.3;
            margin-bottom: 4px;
        }

        .item-category {
            font-size: 11px;
            color: #b0b3b8;
            margin-bottom: 8px;
        }

        .availability-indicator {
            font-size: 16px;
            margin-left: 8px;
            flex-shrink: 0;
        }

        .item-details {
            display: flex;
            gap: 8px;
            align-items: center;
            font-size: 11px;
            margin-top: auto;
        }

        .tier-badge {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 10px;
        }

        .crafted-location {
            color: #b0b3b8;
            font-size: 10px;
            flex: 1;
            text-align: right;
        }

        .shopping-cart {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
            max-height: 700px;
            overflow-y: auto;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .cart-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #ffffff;
        }

        .cart-count {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
        }

        .cart-items {
            min-height: 200px;
        }

        .cart-empty {
            text-align: center;
            color: #666;
            padding: 40px 20px;
            font-style: italic;
        }

        .cart-item {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .cart-item:hover {
            background: rgba(255,255,255,0.12);
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 2px;
            font-size: 13px;
        }

        .cart-item-details {
            font-size: 11px;
            color: #b0b3b8;
        }

        .cart-item-quantity {
            background: rgba(0, 212, 255, 0.2);
            color: #00d4ff;
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: 700;
            font-size: 12px;
            margin: 0 10px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            flex: 1;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn.primary {
            background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%);
            color: white;
        }

        .btn.secondary {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn.remove {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
            min-width: auto;
            padding: 4px 8px;
            font-size: 12px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .results-panel {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .results-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #00d4ff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .resource-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .resource-item:last-child {
            border-bottom: none;
        }

        .resource-name {
            color: #ffffff;
            font-weight: 500;
            font-size: 13px;
        }

        .resource-amount {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: 700;
            font-size: 12px;
        }

        .success-banner {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-weight: 600;
            text-align: center;
        }

        .map-info {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
        }

        .map-info h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .map-info p {
            color: #b0b3b8;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }

        .resource-badge {
            background: rgba(255,255,255,0.1);
            padding: 6px 10px;
            border-radius: 8px;
            text-align: center;
            font-size: 11px;
            color: #ffffff;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .stats-panel {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            font-size: 12px;
            color: #b0b3b8;
        }

        .stats-panel div {
            margin-bottom: 5px;
        }

        .stats-panel div:last-child {
            margin-bottom: 0;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .search-controls {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .action-buttons {
                flex-direction: column;
            }

            .items-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading-screen">
            <div class="loading-spinner"></div>
            <div class="loading-text">🚀 Loading ICARUS Complete...</div>
            <div class="loading-details">Fetching recipe database...</div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // List of JSON files to attempt loading from icarus_data directory
        const JSON_FILES = [
            'ammunition.json',
            'armor.json',
            'building.json',
            'consumables.json',
            'cooking.json',
            'decoration.json',
            'deployables.json',
            'electricity_sources.json',
            'farming.json',
            'fuel_sources.json',
            'furniture.json',
            'inventory.json',
            'light_sources.json',
            'materials.json',
            'medicine.json',
            'raw_materials.json',
            'specialized_equipment.json',
            'storage.json',
            'tools.json',
            'water_sources.json',
            'weapons.json'
        ];

        // Map resource availability - COMPREHENSIVE MAPPING
        const MAP_RESOURCES = {
            "Olympus": [
                // Basic materials - always available
                "Stone", "Wood", "Stick", "Sticks", "Fiber", "Leather", "Fur", "Bone", "Clay", "Ice", "Water",
                "Coal", "Oxite", "Sulfur", "Silica", "Tree Sap", "Carbon Paste", "Salt",
                
                // Ores - all available on Olympus
                "Iron Ore", "Copper Ore", "Gold Ore", "Aluminum Ore", "Platinum Ore", "Titanium Ore",
                "Exotics", "Exotic Matter",
                
                // Processed materials - craftable on Olympus
                "Iron Ingot", "Steel Ingot", "Steel Bloom", "Aluminum Ingot", "Copper Ingot", 
                "Platinum Ingot", "Titanium Ingot", "Refined Gold", "Steel Screw", "Copper Wire",
                "Gold Wire", "Electronics", "Carbon Fiber", "Composites", "Epoxy", "Organic Resin",
                "Concrete Mix", "Glass", "Rope", "Wool", "Charcoal", "Biofuel Can", "Iron Nail", "Copper Nail",
                
                // Creature materials
                "Brown Bear Fur", "Brown Bear Leather", "Brown Bear Bone",
                "Wolf Fur", "Wolf Leather", "Wolf Bone",
                "Deer Fur", "Deer Leather", "Deer Bone",
                "Mammoth Tusk", "Caveworm Chitin",
                
                // Food/farming materials
                "Pumpkin", "Corn", "Wheat", "Carrot", "Potato", "Tomato", "Beans", "Berry", "Apple",
                "Reed Flower", "Reed", "Flower", "Mushroom", "Fruit", "Vegetable", "Grain", "Seed"
            ],
            "Styx": [
                // Same as Olympus - Styx has same resource distribution
                "Stone", "Wood", "Stick", "Sticks", "Fiber", "Leather", "Fur", "Bone", "Clay", "Ice", "Water",
                "Coal", "Oxite", "Sulfur", "Silica", "Tree Sap", "Carbon Paste", "Salt",
                "Iron Ore", "Copper Ore", "Gold Ore", "Aluminum Ore", "Platinum Ore", "Titanium Ore",
                "Exotics", "Exotic Matter", "Caveworm Chitin",
                "Iron Ingot", "Steel Ingot", "Steel Bloom", "Aluminum Ingot", "Copper Ingot", 
                "Platinum Ingot", "Titanium Ingot", "Refined Gold", "Steel Screw", "Copper Wire",
                "Gold Wire", "Electronics", "Carbon Fiber", "Composites", "Epoxy", "Organic Resin",
                "Concrete Mix", "Glass", "Rope", "Wool", "Charcoal", "Biofuel Can", "Iron Nail", "Copper Nail",
                "Brown Bear Fur", "Brown Bear Leather", "Brown Bear Bone",
                "Wolf Fur", "Wolf Leather", "Wolf Bone",
                "Deer Fur", "Deer Leather", "Deer Bone",
                "Pumpkin", "Corn", "Wheat", "Carrot", "Potato", "Tomato", "Beans", "Berry", "Apple",
                "Reed Flower", "Reed", "Flower", "Mushroom", "Fruit", "Vegetable", "Grain", "Seed"
            ],
            "Prometheus": [
                // Prometheus has everything plus Obsidian
                "Stone", "Wood", "Stick", "Sticks", "Fiber", "Leather", "Fur", "Bone", "Clay", "Ice", "Water",
                "Coal", "Oxite", "Sulfur", "Silica", "Tree Sap", "Carbon Paste", "Salt",
                "Iron Ore", "Copper Ore", "Gold Ore", "Aluminum Ore", "Platinum Ore", "Titanium Ore",
                "Exotics", "Exotic Matter", "Obsidian", "Shaped Obsidian", "Caveworm Chitin",
                "Iron Ingot", "Steel Ingot", "Steel Bloom", "Aluminum Ingot", "Copper Ingot", 
                "Platinum Ingot", "Titanium Ingot", "Refined Gold", "Steel Screw", "Copper Wire",
                "Gold Wire", "Electronics", "Carbon Fiber", "Composites", "Epoxy", "Organic Resin",
                "Concrete Mix", "Glass", "Rope", "Wool", "Charcoal", "Biofuel Can", "Iron Nail", "Copper Nail",
                "Brown Bear Fur", "Brown Bear Leather", "Brown Bear Bone",
                "Wolf Fur", "Wolf Leather", "Wolf Bone",
                "Deer Fur", "Deer Leather", "Deer Bone",
                "Pumpkin", "Corn", "Wheat", "Carrot", "Potato", "Tomato", "Beans", "Berry", "Apple",
                "Reed Flower", "Reed", "Flower", "Mushroom", "Fruit", "Vegetable", "Grain", "Seed"
            ]
        };

        function ItemCard({ item, recipe, isSelected, isAvailable, onClick, onQuantityChange, currentQuantity }) {
            const getTierColor = (tier) => {
                switch(tier) {
                    case 0: return "#888"; // Raw materials
                    case 1: return "#4ecdc4"; // Basic
                    case 2: return "#45b7d1"; // Iron
                    case 3: return "#f39c12"; // Steel
                    case 4: return "#e74c3c"; // Advanced
                    default: return "#4ecdc4";
                }
            };

            const getIcon = (category) => {
                switch(category) {
                    case "Tools": return "🔧";
                    case "Weapons": return "⚔️";
                    case "Armor": return "🛡️";
                    case "Deployables": return "🏭";
                    case "Specialized Equipment": return "⚙️";
                    case "Building": return "🏗️";
                    case "Cooking": return "🍳";
                    case "Storage": return "📦";
                    case "Furniture": return "🪑";
                    case "Materials": return "🔩";
                    case "Raw Materials": return "⛏️";
                    case "Water Sources": return "💧";
                    case "Electricity Sources": return "⚡";
                    case "Fuel Sources": return "⛽";
                    case "Light Sources": return "💡";
                    case "Farming": return "🌱";
                    case "Consumables": return "🧪";
                    case "Medicine": return "💊";
                    case "Ammunition": return "🏹";
                    case "Inventory": return "🎒";
                    case "Decoration": return "🎨";
                    default: return "📋";
                }
            };

            return React.createElement('div', {
                className: `item-card ${isSelected ? 'selected' : ''} ${!isAvailable ? 'unavailable' : ''}`,
                'data-item': item
            }, [
                React.createElement('div', { className: 'item-header', key: 'header' }, [
                    React.createElement('div', { key: 'info' }, [
                        React.createElement('div', { className: 'item-name', key: 'name' }, 
                            `${getIcon(recipe.category)} ${item}`
                        ),
                        React.createElement('div', { className: 'item-category', key: 'category' }, 
                            recipe.category
                        )
                    ]),
                    React.createElement('div', { className: 'availability-indicator', key: 'availability' }, 
                        isAvailable ? "✅" : "❌"
                    )
                ]),
                React.createElement('div', { className: 'item-details', key: 'details' }, [
                    React.createElement('span', { 
                        className: 'tier-badge', 
                        key: 'tier',
                        style: { background: getTierColor(recipe.tier) }
                    }, `T${recipe.tier}`),
                    React.createElement('span', { className: 'crafted-location', key: 'location' }, 
                        recipe.crafted_at
                    )
                ]),
                React.createElement('div', { 
                    className: 'quantity-controls', 
                    key: 'quantity-controls',
                    style: {
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px',
                        marginTop: '10px',
                        padding: '8px',
                        background: 'rgba(255,255,255,0.05)',
                        borderRadius: '8px'
                    }
                }, [
                    React.createElement('button', {
                        key: 'decrease',
                        onClick: (e) => {
                            e.stopPropagation();
                            if (currentQuantity > 0) {
                                onQuantityChange(item, currentQuantity - 1);
                            }
                        },
                        style: {
                            background: '#ff6b6b',
                            color: 'white',
                            border: 'none',
                            borderRadius: '6px',
                            width: '24px',
                            height: '24px',
                            cursor: 'pointer',
                            fontSize: '14px',
                            fontWeight: 'bold'
                        }
                    }, '-'),
                    React.createElement('span', {
                        key: 'quantity-display',
                        style: {
                            minWidth: '20px',
                            textAlign: 'center',
                            fontSize: '14px',
                            fontWeight: 'bold',
                            color: '#00d4ff'
                        }
                    }, currentQuantity || 0),
                    React.createElement('button', {
                        key: 'increase',
                        onClick: (e) => {
                            e.stopPropagation();
                            onQuantityChange(item, (currentQuantity || 0) + 1);
                        },
                        style: {
                            background: '#4ecdc4',
                            color: 'white',
                            border: 'none',
                            borderRadius: '6px',
                            width: '24px',
                            height: '24px',
                            cursor: 'pointer',
                            fontSize: '14px',
                            fontWeight: 'bold'
                        }
                    }, '+'),
                    React.createElement('button', {
                        key: 'add-to-cart',
                        onClick: (e) => {
                            e.stopPropagation();
                            if (currentQuantity > 0) {
                                onClick(item);
                            }
                        },
                        disabled: !currentQuantity || currentQuantity === 0,
                        style: {
                            background: currentQuantity > 0 ? '#00d4ff' : '#666',
                            color: 'white',
                            border: 'none',
                            borderRadius: '6px',
                            padding: '4px 8px',
                            cursor: currentQuantity > 0 ? 'pointer' : 'not-allowed',
                            fontSize: '11px',
                            fontWeight: 'bold',
                            marginLeft: '4px'
                        }
                    }, 'Add')
                ])
            ]);
        }

        function CartItem({ item, details, onRemove, recipes }) {
            return React.createElement('div', { className: 'cart-item', 'data-item': item }, [
                React.createElement('div', { className: 'cart-item-info', key: 'info' }, [
                    React.createElement('div', { className: 'cart-item-name', key: 'name' }, item),
                    React.createElement('div', { className: 'cart-item-details', key: 'details' }, 
                        `${recipes[item]?.crafted_at || "Unknown"} • T${recipes[item]?.tier || 0}`
                    )
                ]),
                React.createElement('div', { className: 'cart-item-quantity', key: 'quantity' }, `${details.quantity}x`),
                React.createElement('button', {
                    key: 'remove',
                    className: 'btn remove',
                    onClick: () => onRemove(item)
                }, "✕")
            ]);
        }

        function CraftingCalculator() {
            const [recipes, setRecipes] = useState({});
            const [loading, setLoading] = useState(true);
            const [loadingText, setLoadingText] = useState('Fetching recipe database...');
            const [error, setError] = useState(null);
            const [activeTab, setActiveTab] = useState('calculator');
            const [currentMap, setCurrentMap] = useState('Olympus');
            const [searchTerm, setSearchTerm] = useState('');
            const [categoryFilter, setCategoryFilter] = useState('All');
            const [tierFilter, setTierFilter] = useState('All');
            const [shoppingCart, setShoppingCart] = useState({});
            const [results, setResults] = useState(null);
            const [checkedItems, setCheckedItems] = useState({});
            const [itemQuantities, setItemQuantities] = useState({}); // Track individual item quantities

            useEffect(() => {
                loadRecipes();
            }, []);

            const loadRecipes = async () => {
                try {
                    setLoading(true);
                    setError(null);
                    setLoadingText('Fetching recipe database...');
                    
                    const allRecipes = {};
                    let loadedCount = 0;
                    const errors = [];
                    
                    // Try different path variations
                    const pathVariations = [
                        './icarus_data/',
                        'icarus_data/',
                        '../icarus_data/',
                        '/icarus_data/'
                    ];
                    
                    let successfulPath = null;
                    
                    // Test with a single file first to find the correct path
                    for (const basePath of pathVariations) {
                        try {
                            setLoadingText(`Testing path: ${basePath}...`);
                            const testResponse = await fetch(`${basePath}medicine.json`);
                            if (testResponse.ok) {
                                successfulPath = basePath;
                                setLoadingText(`Found data at: ${basePath}`);
                                break;
                            }
                        } catch (e) {
                            console.log(`Path ${basePath} failed:`, e.message);
                        }
                    }
                    
                    if (!successfulPath) {
                        throw new Error(`CORS Error: Cannot load JSON files directly from file:// protocol. 
                        
Please use one of these solutions:
1. Start a local HTTP server:
   - Python: 'python -m http.server 8000' then open http://localhost:8000/icarus_calculator.html
   - Node.js: 'npx http-server' then open the provided URL
   - VS Code: Install 'Live Server' extension and right-click HTML file
                        
2. Or place files on a web server`);
                    }
                    
                    // Load all JSON files using the successful path
                    for (const filename of JSON_FILES) {
                        try {
                            setLoadingText(`Loading ${filename}... (${loadedCount + 1}/${JSON_FILES.length})`);
                            
                            const response = await fetch(`${successfulPath}${filename}`);
                            if (!response.ok) {
                                errors.push(`${filename}: HTTP ${response.status}`);
                                console.warn(`Failed to load ${filename}: ${response.status}`);
                                continue;
                            }
                            
                            const data = await response.json();
                            console.log(`Loaded ${filename}:`, data);
                            
                            // Convert JSON format to recipes format
                            if (data.items && Array.isArray(data.items)) {
                                data.items.forEach(item => {
                                    // Convert ingredients format
                                    const ingredients = {};
                                    if (item.ingredients && typeof item.ingredients === 'object') {
                                        Object.entries(item.ingredients).forEach(([key, value]) => {
                                            if (key !== 'Max' && typeof value === 'number') {
                                                ingredients[key] = value;
                                            }
                                        });
                                    }
                                    
                                    allRecipes[item.name] = {
                                        ingredients: ingredients,
                                        crafted_at: item.crafted_at || 'Unknown',
                                        category: item.category || 'Unknown',
                                        tier: item.tier || 0,
                                        map_exclusive: item.map_exclusive || null
                                    };
                                });
                            }
                            
                            loadedCount++;
                        } catch (fileError) {
                            errors.push(`${filename}: ${fileError.message}`);
                            console.warn(`Error loading ${filename}:`, fileError);
                        }
                    }
                    
                    setLoadingText(`Processing ${Object.keys(allRecipes).length} recipes...`);
                    
                    const successfulFiles = loadedCount;
                    const totalFiles = JSON_FILES.length;
                    
                    if (Object.keys(allRecipes).length === 0) {
                        throw new Error(`No recipes could be loaded. 
                        
Files attempted: ${JSON_FILES.length}
Successfully loaded: ${loadedCount}
Errors encountered: ${errors.length}

Detailed errors:
${errors.join('\n')}

This indicates all JSON files are missing or invalid.`);
                    }
                    
                    // Success! Even if only partial files loaded
                    setRecipes(allRecipes);
                    setLoading(false);
                    
                    // Show a warning if some files are missing, but don't error out
                    if (successfulFiles < totalFiles) {
                        setResults({
                            type: 'success',
                            message: `Loaded ${Object.keys(allRecipes).length} recipes from ${successfulFiles}/${totalFiles} files. Some files were missing but calculator is functional!`
                        });
                        setTimeout(() => setResults(null), 5000);
                    }
                    
                    console.log(`Successfully loaded ${Object.keys(allRecipes).length} recipes from ${loadedCount}/${totalFiles} files`);
                    
                } catch (err) {
                    console.error('Error loading recipes:', err);
                    setError({
                        title: 'Failed to Load Recipe Database',
                        message: err.message,
                        details: `Current URL: ${window.location.href}
                        Protocol: ${window.location.protocol}
                        
                        If using file:// protocol, you need to serve files via HTTP.`
                    });
                    setLoading(false);
                }
            };

            const categories = [...new Set(Object.values(recipes).map(r => r.category))].sort();
            const tiers = [...new Set(Object.values(recipes).map(r => r.tier))].sort();

            const toggleChecked = (itemKey) => {
                setCheckedItems(prev => ({
                    ...prev,
                    [itemKey]: !prev[itemKey]
                }));
            };

            const clearAllChecks = () => {
                setCheckedItems({});
            };

            const handleQuantityChange = (item, quantity) => {
                setItemQuantities(prev => ({
                    ...prev,
                    [item]: Math.max(0, quantity)
                }));
            };

            const getCompletionStats = () => {
                if (!results || results.type !== 'hierarchical') return null;
                
                const allItems = [];
                const addToList = (tree, prefix = '') => {
                    Object.entries(tree).forEach(([item, data]) => {
                        const key = `${prefix}${item}`;
                        allItems.push(key);
                        if (data.ingredients) {
                            Object.keys(data.ingredients).forEach(ingredient => {
                                const ingredientKey = `${key}-${ingredient}`;
                                allItems.push(ingredientKey);
                            });
                        }
                    });
                };
                
                addToList(results.craftingTree);
                Object.keys(results.rawMaterials).forEach(material => {
                    allItems.push(`raw-${material}`);
                });
                
                const completed = allItems.filter(item => checkedItems[item]).length;
                const total = allItems.length;
                
                return { completed, total, percentage: total > 0 ? Math.round((completed / total) * 100) : 0 };
            };

            const filteredItems = Object.entries(recipes).filter(([item, recipe]) => {
                const matchesSearch = item.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesCategory = categoryFilter === 'All' || recipe.category === categoryFilter;
                const matchesTier = tierFilter === 'All' || recipe.tier.toString() === tierFilter;
                return matchesSearch && matchesCategory && matchesTier;
            });

            const checkItemAvailability = (item, map, debugPath = []) => {
                const recipe = recipes[item];
                if (!recipe) {
                    if (debugPath.length === 0) console.log(`❌ No recipe found for: ${item}`);
                    return false;
                }
                
                // Prevent infinite recursion
                if (debugPath.includes(item)) {
                    return false;
                }
                
                // Check for map-exclusive items first
                if (recipe.map_exclusive && recipe.map_exclusive !== map) {
                    if (debugPath.length === 0) console.log(`🗺️ Map exclusive item: ${item} (requires ${recipe.map_exclusive}, checking ${map})`);
                    return false;
                }
                
                const requiredMaterials = Object.keys(recipe.ingredients || {});
                
                // If no ingredients, it's likely a raw material or basic item
                if (requiredMaterials.length === 0) {
                    // Be very permissive for items without ingredients
                    const isAvailable = MAP_RESOURCES[map]?.includes(item) || 
                           recipe.crafted_at === 'Character' ||
                           recipe.crafted_at === 'Character Crafting' ||
                           recipe.category === 'Raw Materials' ||
                           recipe.category === 'Consumables' ||
                           recipe.tier <= 1;  // Tier 0 and 1 items should generally be available
                    
                    return isAvailable;
                }
                
                // For items with ingredients, be more permissive with basic materials
                for (const material of requiredMaterials) {
                    // Comprehensive list of materials that should always be considered available
                    const alwaysAvailableMaterials = [
                        // Basic gathered materials
                        'Fiber', 'Wood', 'Stone', 'Stick', 'Sticks', 'Leather', 'Fur', 'Bone', 'Clay', 'Wool',
                        
                        // Basic ores (available in caves on all maps)
                        'Iron Ore', 'Copper Ore', 'Coal', 'Gold Ore', 'Aluminum Ore', 'Platinum Ore', 'Titanium Ore',
                        
                        // Basic processed materials
                        'Iron Ingot', 'Steel Ingot', 'Copper Ingot', 'Steel Bloom', 'Oxite', 'Sulfur', 'Tree Sap', 'Cold Steel Ingot',
                        
                        // Basic creature materials
                        'Brown Bear Leather', 'Brown Bear Fur', 'Brown Bear Bone',
                        'Wolf Leather', 'Wolf Fur', 'Wolf Bone',
                        'Deer Leather', 'Deer Fur', 'Deer Bone',
                        
                        // Basic crafted materials
                        'Rope', 'Glass', 'Charcoal', 'Carbon Paste', 'Iron Nail', 'Copper Nail', 'Steel Screw',
                        
                        // Water and consumables
                        'Water', 'Ice', 'Salt',
                        
                        // Food/farming materials that should be available
                        'Pumpkin', 'Corn', 'Wheat', 'Carrot', 'Potato', 'Tomato', 'Beans', 'Berry', 'Apple',
                        'Reed Flower', 'Reed', 'Flower', 'Mushroom', 'Fruit', 'Vegetable', 'Grain', 'Seed',
                        
                        // Common crafting components
                        'Nail', 'Screw', 'Wire', 'Paste', 'Mix', 'Bloom', 'Bar', 'Ingot',
                        
                        // Basic building materials
                        'Thatch', 'Plank', 'Board', 'Beam'
                    ];
                    
                    // Handle common plural/singular variations
                    const materialVariations = [
                        material,
                        material.replace(/s$/, ''), // Remove trailing 's'
                        material + 's',             // Add trailing 's'
                        material.replace('Sticks', 'Stick'), // Specific fix for Sticks->Stick
                        material.replace('Stick', 'Sticks')  // And reverse
                    ];
                    
                    // Check if any variation of the material is available
                    const isBasicMaterial = materialVariations.some(variation => 
                        alwaysAvailableMaterials.includes(variation) || 
                        MAP_RESOURCES[map]?.includes(variation)
                    );
                    
                    if (isBasicMaterial) {
                        continue; // This material is available
                    }
                    
                    // Recursively check the material
                    const materialAvailable = checkItemAvailability(material, map, [...debugPath, item]);
                    
                    if (!materialAvailable) {
                        if (debugPath.length === 0) {
                            console.log(`❌ Missing ingredient for ${item}: ${material}`);
                        }
                        return false;
                    }
                }
                
                if (debugPath.length === 0) {
                    console.log(`✅ Available: ${item} (ingredients: ${requiredMaterials.join(', ')})`);
                }
                return true;
            };

            const addToCart = (item) => {
                const quantity = itemQuantities[item] || 1;
                setShoppingCart(prev => ({
                    ...prev,
                    [item]: {
                        quantity: (prev[item]?.quantity || 0) + quantity
                    }
                }));
                
                // Reset the item quantity after adding to cart
                setItemQuantities(prev => ({
                    ...prev,
                    [item]: 0
                }));
                
                setResults({ type: 'success', message: `${quantity}x ${item} added to cart!` });
                setTimeout(() => setResults(null), 2000);
            };

            const removeFromCart = (item) => {
                setShoppingCart(prev => {
                    const newCart = { ...prev };
                    delete newCart[item];
                    return newCart;
                });
            };

            const clearCart = () => {
                setShoppingCart({});
                setCheckedItems({});
                setItemQuantities({});
                setResults({ type: 'success', message: 'Cart cleared!' });
                setTimeout(() => setResults(null), 2000);
            };

            const calculateRequirements = () => {
                if (Object.keys(shoppingCart).length === 0) {
                    setResults({ type: 'error', message: 'Cart is empty!' });
                    setTimeout(() => setResults(null), 3000);
                    return;
                }

                // Clear previous results first to prevent flickering
                setResults({ type: 'loading', message: 'Calculating...' });

                // Use setTimeout to ensure the loading state is rendered
                setTimeout(() => {
                    const craftingTree = {};
                    const rawMaterials = {};
                    
                    const buildCraftingTree = (item, quantity, path = []) => {
                        const recipe = recipes[item];
                        if (!recipe) return;
                        
                        // Avoid circular dependencies
                        if (path.includes(item)) return;
                        
                        if (Object.keys(recipe.ingredients).length === 0) {
                            // Raw material
                            rawMaterials[item] = (rawMaterials[item] || 0) + quantity;
                            return;
                        }
                        
                        // Crafted item - add to tree
                        if (!craftingTree[item]) {
                            craftingTree[item] = {
                                totalNeeded: 0,
                                craftedAt: recipe.crafted_at,
                                tier: recipe.tier,
                                category: recipe.category,
                                ingredients: {}
                            };
                        }
                        
                        craftingTree[item].totalNeeded += quantity;
                        
                        // Process ingredients
                        Object.entries(recipe.ingredients).forEach(([material, amount]) => {
                            const totalAmount = amount * quantity;
                            
                            if (!craftingTree[item].ingredients[material]) {
                                craftingTree[item].ingredients[material] = 0;
                            }
                            craftingTree[item].ingredients[material] += totalAmount;
                            
                            // Recursively process this material
                            buildCraftingTree(material, totalAmount, [...path, item]);
                        });
                    };

                    // Build the tree for all cart items
                    Object.entries(shoppingCart).forEach(([item, details]) => {
                        buildCraftingTree(item, details.quantity);
                    });

                    setResults({
                        type: 'hierarchical',
                        craftingTree,
                        rawMaterials,
                        cartItems: shoppingCart
                    });
                }, 100);
            };

            if (loading) {
                return React.createElement('div', { className: 'app-container' }, [
                    React.createElement('div', { className: 'app-header', key: 'header' }, [
                        React.createElement('h1', { className: 'app-title', key: 'title' }, "🚀 ICARUS COMPLETE"),
                        React.createElement('p', { className: 'app-subtitle', key: 'subtitle' }, "Advanced Crafting Calculator with Complete Game Database")
                    ]),
                    React.createElement('div', { className: 'loading-screen', key: 'loading' }, [
                        React.createElement('div', { className: 'loading-spinner', key: 'spinner' }),
                        React.createElement('div', { className: 'loading-text', key: 'text' }, '🚀 Loading ICARUS Complete...'),
                        React.createElement('div', { className: 'loading-details', key: 'details' }, loadingText)
                    ])
                ]);
            }

            if (error) {
                return React.createElement('div', { className: 'app-container' }, [
                    React.createElement('div', { className: 'app-header', key: 'header' }, [
                        React.createElement('h1', { className: 'app-title', key: 'title' }, "🚀 ICARUS COMPLETE"),
                        React.createElement('p', { className: 'app-subtitle', key: 'subtitle' }, "Advanced Crafting Calculator")
                    ]),
                    React.createElement('div', { className: 'error-screen', key: 'error' }, [
                        React.createElement('div', { className: 'error-title', key: 'title' }, `❌ ${error.title}`),
                        React.createElement('div', { className: 'error-message', key: 'message' }, error.message),
                        error.details && React.createElement('div', { 
                            key: 'details',
                            style: { 
                                fontSize: '0.9rem', 
                                color: '#b0b3b8', 
                                marginBottom: '20px',
                                fontFamily: 'monospace'
                            } 
                        }, error.details),
                        React.createElement('button', {
                            key: 'retry',
                            className: 'retry-button',
                            onClick: loadRecipes
                        }, 'Retry Loading')
                    ])
                ]);
            }

            const renderTabContent = () => {
                switch (activeTab) {
                    case 'calculator':
                        return React.createElement('div', { key: 'calculator-content' }, [
                            React.createElement('div', { className: 'search-controls', key: 'controls' }, [
                                React.createElement('input', {
                                    key: 'search',
                                    type: 'text',
                                    placeholder: 'Search items...',
                                    className: 'search-input',
                                    value: searchTerm,
                                    onChange: (e) => setSearchTerm(e.target.value)
                                }),
                                React.createElement('select', {
                                    key: 'category',
                                    className: 'filter-select',
                                    value: categoryFilter,
                                    onChange: (e) => setCategoryFilter(e.target.value)
                                }, [
                                    React.createElement('option', { key: 'all', value: 'All' }, 'All Categories'),
                                    ...categories.map(cat => 
                                        React.createElement('option', { key: cat, value: cat }, cat)
                                    )
                                ]),
                                React.createElement('select', {
                                    key: 'tier',
                                    className: 'filter-select',
                                    value: tierFilter,
                                    onChange: (e) => setTierFilter(e.target.value)
                                }, [
                                    React.createElement('option', { key: 'all', value: 'All' }, 'All Tiers'),
                                    ...tiers.map(tier => 
                                        React.createElement('option', { key: tier, value: tier.toString() }, `Tier ${tier}`)
                                    )
                                ])
                            ]),
                            React.createElement('div', { className: 'map-selector', key: 'map-selector' }, [
                                React.createElement('span', { className: 'map-label', key: 'label' }, 'Map:'),
                                ...Object.keys(MAP_RESOURCES).map(map =>
                                    React.createElement('button', {
                                        key: map,
                                        className: `map-btn ${currentMap === map ? 'active' : ''}`,
                                        onClick: () => setCurrentMap(map)
                                    }, map)
                                )
                            ]),
                            React.createElement('div', { className: 'items-grid', key: 'items' },
                                filteredItems.map(([item, recipe]) =>
                                    React.createElement(ItemCard, {
                                        key: item,
                                        item,
                                        recipe,
                                        isSelected: !!shoppingCart[item],
                                        isAvailable: checkItemAvailability(item, currentMap),
                                        onClick: addToCart,
                                        onQuantityChange: handleQuantityChange,
                                        currentQuantity: itemQuantities[item] || 0
                                    })
                                )
                            ),
                            results && renderResults()
                        ]);

                    case 'map':
                        return React.createElement('div', { className: 'map-info', key: 'map-info' }, [
                            React.createElement('h3', { key: 'title' }, `🗺️ ${currentMap} Resources`),
                            React.createElement('p', { key: 'description' }, 
                                currentMap === 'Olympus' ? "The starter map with Forest, Arctic, and Desert biomes. ALL ORES available in caves including Platinum and Titanium!" :
                                currentMap === 'Prometheus' ? "🌋 Volcanic DLC map with unique Obsidian deposits. Biome-specific ore distribution in caves." :
                                currentMap === 'Styx' ? "💎 Advanced DLC map with all standard ores available. Same ore distribution as Olympus." : ""
                            ),
                            React.createElement('div', { className: 'resource-grid', key: 'resources' },
                                MAP_RESOURCES[currentMap]?.map(resource =>
                                    React.createElement('div', {
                                        key: resource,
                                        className: 'resource-badge'
                                    }, resource)
                                )
                            )
                        ]);

                    default:
                        return null;
                }
            };

            const renderResults = () => {
                if (!results) return null;
                
                switch (results.type) {
                    case 'success':
                        return React.createElement('div', { className: 'success-banner' }, `✅ ${results.message}`);
                    
                    case 'loading':
                        return React.createElement('div', { 
                            style: { 
                                background: 'rgba(0, 212, 255, 0.1)', 
                                color: '#00d4ff', 
                                padding: '15px', 
                                borderRadius: '10px', 
                                marginTop: '15px',
                                textAlign: 'center',
                                fontWeight: '600'
                            } 
                        }, `⏳ ${results.message}`);
                    
                    case 'hierarchical':
                        const renderCraftingStep = (item, data, depth = 0, parentKey = '') => {
                            const recipe = recipes[item];
                            const isAvailable = checkItemAvailability(item, currentMap);
                            const indent = depth * 20;
                            const itemKey = parentKey ? `${parentKey}-${item}` : item;
                            const isChecked = checkedItems[itemKey];
                            
                            return React.createElement('div', {
                                key: `${item}-${depth}`,
                                style: {
                                    marginLeft: `${indent}px`,
                                    marginBottom: '8px',
                                    padding: '8px',
                                    background: depth === 0 ? 'rgba(0, 212, 255, 0.1)' : 
                                               depth === 1 ? 'rgba(255, 255, 255, 0.05)' : 
                                               'rgba(255, 255, 255, 0.02)',
                                    border: `1px solid ${depth === 0 ? 'rgba(0, 212, 255, 0.3)' : 'rgba(255, 255, 255, 0.1)'}`,
                                    borderRadius: '6px',
                                    borderLeft: `4px solid ${getTierColor(recipe?.tier || 0)}`,
                                    opacity: isChecked ? 0.6 : 1,
                                    transition: 'opacity 0.3s ease'
                                }
                            }, [
                                React.createElement('div', {
                                    key: 'header',
                                    style: {
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        marginBottom: Object.keys(data.ingredients || {}).length > 0 ? '8px' : '0'
                                    }
                                }, [
                                    React.createElement('div', {
                                        key: 'left-content',
                                        style: { display: 'flex', alignItems: 'center', gap: '8px' }
                                    }, [
                                        React.createElement('input', {
                                            key: 'checkbox',
                                            type: 'checkbox',
                                            checked: isChecked || false,
                                            onChange: () => toggleChecked(itemKey),
                                            style: {
                                                width: '16px',
                                                height: '16px',
                                                cursor: 'pointer',
                                                accentColor: '#00d4ff'
                                            }
                                        }),
                                        React.createElement('span', {
                                            key: 'name',
                                            style: {
                                                fontWeight: depth === 0 ? '700' : '600',
                                                color: isAvailable ? '#ffffff' : '#ff6b6b',
                                                fontSize: depth === 0 ? '14px' : '13px',
                                                textDecoration: isChecked ? 'line-through' : 'none'
                                            }
                                        }, `${isAvailable ? '✅' : '❌'} ${data.totalNeeded}x ${item}`)
                                    ]),
                                    React.createElement('span', {
                                        key: 'info',
                                        style: {
                                            fontSize: '11px',
                                            color: '#b0b3b8'
                                        }
                                    }, `${recipe?.crafted_at || 'Raw'} • T${recipe?.tier || 0}`)
                                ]),
                                Object.keys(data.ingredients || {}).length > 0 && React.createElement('div', {
                                    key: 'ingredients',
                                    style: { marginLeft: '10px' }
                                }, Object.entries(data.ingredients).map(([ingredient, amount]) => {
                                    const ingredientData = results.craftingTree[ingredient];
                                    if (ingredientData) {
                                        return renderCraftingStep(ingredient, ingredientData, depth + 1, itemKey);
                                    } else {
                                        // Raw material
                                        const isRawAvailable = MAP_RESOURCES[currentMap]?.includes(ingredient);
                                        const rawKey = `${itemKey}-${ingredient}`;
                                        const isRawChecked = checkedItems[rawKey];
                                        
                                        return React.createElement('div', {
                                            key: ingredient,
                                            style: {
                                                marginLeft: `${(depth + 1) * 20}px`,
                                                marginBottom: '4px',
                                                padding: '4px 8px',
                                                background: 'rgba(255, 255, 255, 0.02)',
                                                border: '1px solid rgba(255, 255, 255, 0.05)',
                                                borderRadius: '4px',
                                                fontSize: '12px',
                                                color: isRawAvailable ? '#ffffff' : '#ff6b6b',
                                                borderLeft: '3px solid #888',
                                                opacity: isRawChecked ? 0.6 : 1,
                                                transition: 'opacity 0.3s ease',
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: '8px'
                                            }
                                        }, [
                                            React.createElement('input', {
                                                key: 'raw-checkbox',
                                                type: 'checkbox',
                                                checked: isRawChecked || false,
                                                onChange: () => toggleChecked(rawKey),
                                                style: {
                                                    width: '14px',
                                                    height: '14px',
                                                    cursor: 'pointer',
                                                    accentColor: '#00d4ff'
                                                }
                                            }),
                                            React.createElement('span', {
                                                key: 'raw-text',
                                                style: {
                                                    textDecoration: isRawChecked ? 'line-through' : 'none'
                                                }
                                            }, `${isRawAvailable ? '✅' : '❌'} ${amount}x ${ingredient} (Raw Material)`)
                                        ]);
                                    }
                                }))
                            ]);
                        };

                        const getTierColor = (tier) => {
                            switch(tier) {
                                case 0: return "#888";
                                case 1: return "#4ecdc4";
                                case 2: return "#45b7d1";
                                case 3: return "#f39c12";
                                case 4: return "#e74c3c";
                                default: return "#4ecdc4";
                            }
                        };

                        const unavailableRawMaterials = Object.keys(results.rawMaterials).filter(material => 
                            !MAP_RESOURCES[currentMap]?.includes(material)
                        );

                        const completionStats = getCompletionStats();
                        
                        return React.createElement('div', { className: 'results-panel' }, [
                            React.createElement('div', { 
                                className: 'results-title', 
                                key: 'title',
                                style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center' }
                            }, [
                                React.createElement('span', { key: 'title-text' }, '🧮 Complete Crafting Breakdown'),
                                React.createElement('div', { 
                                    key: 'progress-controls',
                                    style: { display: 'flex', alignItems: 'center', gap: '10px' }
                                }, [
                                    completionStats && React.createElement('span', {
                                        key: 'progress',
                                        style: {
                                            fontSize: '12px',
                                            color: completionStats.percentage === 100 ? '#4ecdc4' : '#b0b3b8',
                                            fontWeight: '600'
                                        }
                                    }, `${completionStats.completed}/${completionStats.total} (${completionStats.percentage}%)`),
                                    React.createElement('button', {
                                        key: 'clear-checks',
                                        onClick: clearAllChecks,
                                        style: {
                                            background: 'rgba(255, 107, 107, 0.2)',
                                            color: '#ff6b6b',
                                            border: '1px solid rgba(255, 107, 107, 0.3)',
                                            borderRadius: '6px',
                                            padding: '4px 8px',
                                            fontSize: '11px',
                                            cursor: 'pointer',
                                            fontWeight: '600'
                                        }
                                    }, 'Clear All ✕')
                                ])
                            ]),
                            
                            // Target items from cart
                            React.createElement('div', {
                                key: 'targets',
                                style: { marginBottom: '20px' }
                            }, [
                                React.createElement('h4', {
                                    key: 'targets-title',
                                    style: { 
                                        color: '#00d4ff', 
                                        fontSize: '14px', 
                                        marginBottom: '10px',
                                        fontWeight: '600'
                                    }
                                }, '🎯 Target Items:'),
                                ...Object.entries(results.cartItems).map(([item, details]) => {
                                    const craftingData = results.craftingTree[item];
                                    if (craftingData) {
                                        return renderCraftingStep(item, craftingData, 0);
                                    }
                                    return null;
                                }).filter(Boolean)
                            ]),

                            // Raw materials summary
                            React.createElement('div', {
                                key: 'raw-summary'
                            }, [
                                React.createElement('h4', {
                                    key: 'raw-title',
                                    style: { 
                                        color: '#00d4ff', 
                                        fontSize: '14px', 
                                        marginBottom: '10px',
                                        fontWeight: '600'
                                    }
                                }, '⛏️ Total Raw Materials Summary:'),
                                ...Object.entries(results.rawMaterials).map(([material, amount]) => {
                                    const isAvailable = MAP_RESOURCES[currentMap]?.includes(material);
                                    const rawKey = `raw-${material}`;
                                    const isRawChecked = checkedItems[rawKey];
                                    
                                    return React.createElement('div', { 
                                        key: material, 
                                        className: 'resource-item',
                                        style: { 
                                            opacity: isRawChecked ? 0.6 : (isAvailable ? 1 : 0.6),
                                            transition: 'opacity 0.3s ease',
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '8px'
                                        }
                                    }, [
                                        React.createElement('input', {
                                            key: 'summary-checkbox',
                                            type: 'checkbox',
                                            checked: isRawChecked || false,
                                            onChange: () => toggleChecked(rawKey),
                                            style: {
                                                width: '16px',
                                                height: '16px',
                                                cursor: 'pointer',
                                                accentColor: '#00d4ff'
                                            }
                                        }),
                                        React.createElement('span', { 
                                            className: 'resource-name', 
                                            key: 'name',
                                            style: {
                                                textDecoration: isRawChecked ? 'line-through' : 'none'
                                            }
                                        }, `${isAvailable ? '✅' : '❌'} ${material}`),
                                        React.createElement('span', { 
                                            className: 'resource-amount', 
                                            key: 'amount',
                                            style: {
                                                textDecoration: isRawChecked ? 'line-through' : 'none'
                                            }
                                        }, `${amount}x`)
                                    ])
                                })
                            ]),

                            unavailableRawMaterials.length > 0 && React.createElement('div', {
                                key: 'warning',
                                style: {
                                    marginTop: '15px',
                                    padding: '10px',
                                    background: 'rgba(255, 107, 107, 0.1)',
                                    border: '1px solid rgba(255, 107, 107, 0.3)',
                                    borderRadius: '8px',
                                    fontSize: '12px',
                                    color: '#ff6b6b'
                                }
                            }, `⚠️ ${unavailableRawMaterials.length} raw materials not available on ${currentMap}`)
                        ]);

                    case 'error':
                        return React.createElement('div', { 
                            style: { 
                                background: 'rgba(255, 107, 107, 0.2)', 
                                color: '#ff6b6b', 
                                padding: '15px', 
                                borderRadius: '10px', 
                                marginTop: '15px',
                                textAlign: 'center',
                                fontWeight: '600'
                            } 
                        }, `❌ ${results.message}`);
                    
                    default:
                        return null;
                }
            };

            const availableCount = filteredItems.filter(([item]) => checkItemAvailability(item, currentMap)).length;
            const totalCount = filteredItems.length;
            const totalItems = Object.keys(recipes).length;

            return React.createElement('div', { className: 'app-container' }, [
                React.createElement('div', { className: 'app-header', key: 'header' }, [
                    React.createElement('h1', { className: 'app-title', key: 'title' }, "🚀 ICARUS COMPLETE"),
                    React.createElement('p', { className: 'app-subtitle', key: 'subtitle' }, "Advanced Crafting Calculator with Complete Game Database • JSON-Powered • Live Data"),
                    React.createElement('div', { className: 'stats-header', key: 'stats' }, 
                        `📊 Database: ${totalItems} Total Items • ${availableCount}/${totalCount} Available on ${currentMap}`
                    )
                ]),

                React.createElement('div', { className: 'main-content', key: 'main' }, [
                    React.createElement('div', { className: 'content-panel', key: 'content' }, [
                        React.createElement('div', { className: 'tab-nav', key: 'nav' }, [
                            React.createElement('button', {
                                key: 'calc-tab',
                                className: `tab-button ${activeTab === 'calculator' ? 'active' : ''}`,
                                onClick: () => setActiveTab('calculator')
                            }, "🔨 Calculator"),
                            React.createElement('button', {
                                key: 'map-tab',
                                className: `tab-button ${activeTab === 'map' ? 'active' : ''}`,
                                onClick: () => setActiveTab('map')
                            }, "🗺️ Map Info")
                        ]),

                        React.createElement('div', { className: 'tab-content', key: 'tab-content' }, 
                            renderTabContent()
                        )
                    ]),

                    React.createElement('div', { className: 'shopping-cart', key: 'cart' }, [
                        React.createElement('div', { className: 'cart-header', key: 'cart-header' }, [
                            React.createElement('h3', { className: 'cart-title', key: 'title' }, "🛒 Shopping Cart"),
                            React.createElement('span', { className: 'cart-count', key: 'count' }, Object.keys(shoppingCart).length)
                        ]),

                        React.createElement('div', { className: 'cart-items', key: 'cart-items' },
                            Object.keys(shoppingCart).length === 0 ? 
                                React.createElement('div', { className: 'cart-empty' }, "Add items to your cart to get started!") :
                                Object.entries(shoppingCart).map(([item, details]) =>
                                    React.createElement(CartItem, {
                                        key: item,
                                        item,
                                        details,
                                        onRemove: removeFromCart,
                                        recipes: recipes
                                    })
                                )
                        ),

                        React.createElement('div', { className: 'action-buttons', key: 'actions' }, [
                            React.createElement('button', {
                                key: 'calculate',
                                className: 'btn primary',
                                onClick: calculateRequirements,
                                disabled: Object.keys(shoppingCart).length === 0
                            }, "🧮 Calculate"),
                            React.createElement('button', {
                                key: 'clear',
                                className: 'btn secondary',
                                onClick: clearCart,
                                disabled: Object.keys(shoppingCart).length === 0
                            }, "🗑️ Clear")
                        ]),

                        React.createElement('div', { 
                            className: 'stats-panel',
                            key: 'stats'
                        }, [
                            React.createElement('div', { key: 'available' }, `Available on ${currentMap}: ${availableCount}/${totalCount}`),
                            React.createElement('div', { key: 'total' }, `Total Database: ${totalItems} items`),
                            React.createElement('div', { key: 'cart' }, `Cart Items: ${Object.keys(shoppingCart).length}`)
                        ])
                    ])
                ])
            ]);
        }

        ReactDOM.render(React.createElement(CraftingCalculator), document.getElementById('root'));
    </script>
</body>
</html>